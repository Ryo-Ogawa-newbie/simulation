<!DOCTYPE html>
<html>
<head>
  <title>Equation Solver</title>
</head>
<body>
  <h2>方程式: ax^2 + bx + c = 0</h2>
  <p>a: <input type="number" id="inputA">, b: <input type="number" id="inputB">, c: <input type="number" id="inputC"></p>
  <button onclick="updateEquation()">更新</button>
  
  <br><br>
  
  <button onclick="showInputFields('bisection')">二分法</button>
  <button onclick="showInputFields('newton')">ニュートン法</button>
  
  <div id="methodInputs"></div>
  
  <br><br>
  
  <p>試行回数: <input type="number" id="iterationCount"></p>
  <button onclick="startCalculation()">試行開始</button>
  <button onclick="resetAll()">リセット</button>
  
  <div id="results"></div>
  
  <script>
    var equation = {
      a: null,
      b: null,
      c: null
    };
    
    var methodInputs = {
      bisection: {
        lower: null,
        upper: null
      },
      newton: {
        initialGuess: null
      }
    };
    
    function updateEquation() {
      equation.a = parseFloat(document.getElementById("inputA").value);
      equation.b = parseFloat(document.getElementById("inputB").value);
      equation.c = parseFloat(document.getElementById("inputC").value);
    }
    
    function showInputFields(method) {
      var methodInputsContainer = document.getElementById("methodInputs");
      methodInputsContainer.innerHTML = "";
      
      var methodHeader = document.createElement("h3");
      var inputLabel = document.createElement("label");
      var input = document.createElement("input");
      
      if (method === 'bisection') {
        methodHeader.textContent = "解の範囲";
        inputLabel.textContent = "数字を自由入力 [a, b]";
        input.placeholder = "a";
        input.id = "inputLower";
        methodInputs.bisection.lower = null;
        methodInputs.bisection.upper = null;
        
        var inputUpper = document.createElement("input");
        inputUpper.placeholder = "b";
        inputUpper.id = "inputUpper";
        methodInputsContainer.appendChild(inputUpper);
      } else if (method === 'newton') {
        methodHeader.textContent = "初期推定値";
        inputLabel.textContent = "数字を自由入力";
        input.placeholder = "初期推定値";
        input.id = "inputInitial";
        methodInputs.newton.initialGuess = null;
      }
      
      methodInputsContainer.appendChild(methodHeader);
      methodInputsContainer.appendChild(inputLabel);
      methodInputsContainer.appendChild(input);
    }
    
   // 二分法の計算
  function calculateBisection(a, b, c, lower, upper, iterationCount) {
    var results = [];
    for (var i = 0; i < iterationCount; i++) {
      var midpoint = (lower + upper) / 2;
      var fMid = calculateEquation(a, b, c, midpoint);
      
      if (fMid === 0 || (upper - lower) / 2 < 0.00001) {
        results.push(lower);
        results.push(upper);
        break;
      }
      
      if (fMid * calculateEquation(a, b, c, lower) < 0) {
        upper = midpoint;
      } else {
        lower = midpoint;
      }
    }
    return results;
  }
  
  // ニュートン法の計算
  function calculateNewton(a, b, c, initialGuess, iterationCount) {
    var result = initialGuess;
    for (var i = 0; i < iterationCount; i++) {
      var f = calculateEquation(a, b, c, result);
      var fPrime = calculateDerivative(a, b, result);
      result = result - f / fPrime;
    }
    return result;
  }
  
  // 方程式の計算
  function calculateEquation(a, b, c, x) {
    return a * x * x + b * x + c;
  }
  
  // 方程式の導関数の計算
  function calculateDerivative(a, b, x) {
    return 2 * a * x + b;
  }
</script>
</body>
</html>
